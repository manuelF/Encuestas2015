<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
  var Q="";
  var Q_id=0;
  var question_queue=[];
  var refresh = function() {
    if(question_queue!=null && question_queue.length>0) {
      data = question_queue.shift();
      Q = data["Q"];
      Q_id = data["Q_id"];
      $("#Q").text(Q);
      $("#Qid").text("Q_id: " + Q_id);
     } else {
      $("#Status").text("Aguarde...");
    }
  };
  var getNext = function(data,status) {
   if(data!=null) {
     question_queue.push(data);

    if( $("#Status").text() != "") {
      refresh();
      $("#Status").text("");
    }
   }
  };
  var main = function()
  {
    $("#No").click(function(){$.ajax({url:"respond/"+Q_id+"/N",success:getNext,cache:false}); refresh();});
    $("#Si").click(function(){$.ajax({url:"respond/"+Q_id+"/Y",success:getNext,cache:false}); refresh();});
  };

  var setShortcuts = function() {
    document.onkeydown = function checkKey(e) {
      e = e || window.event;
      if (e.keyCode == '37') { // left arrow
        $("#No").click();
      }
      else if (e.keyCode == '39') { // right arrow
        $("#Si").click();
      }
    };
  };
  var getInitialData = function() {
    for(var i = 0; i<10; i++)
      $.ajax({url:"get/",cache:false,success:getNext});
  }
  $(document).ready(function(){getInitialData(); setShortcuts(); main();});
</script>

<h2>Estudio de elecciones presidenciales 2015</h2>
<p id="Q">Pregunta</p>
<p id="Qid">Q_id: </p>
<img id="No" src="images/cross.png" height="50" width="50">No</img>
<img id="Si" src="images/tick.png" height="50" width="50">Si</img>
<p id="Status"></p>

